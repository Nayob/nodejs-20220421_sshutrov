1. setInterval становится в очередь задач
2. setTimeout становится в очередь задач
3. setInterval выполняется первым т.к. у setInterval и setTimeout одинаковый таймаут. Выводится имя James. setInterval становится в очередь задач после setTimeout
4. Выполняется setTimeout. Создается объект promise его содержимое сразу исполняется. Выводится имя Richard.
5. Разрешение promise встает в очередь микротаск
6. Выводится имя John
7. Так как очередь микротаск не пуста promise резолвится и выводится имя Robert. Второй setTimeout становится в очередь задач после setInterval. Выполняется clearInterval и флаг повторения у setInterval принимает значение false
8. Выполняется setInterval Выводится имя James
9. Выполняется второй setTimeout Выводится имя Michael

Для упрощения пропустил упоминание работы стека, а проверки очереди nexttick за отсутствием таковых конструкций в коде.